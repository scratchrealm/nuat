(function(){"use strict";let u,n,d,g;onmessage=function(t){t.data.canvas&&(u=t.data.canvas,b()),t.data.opts&&(n=t.data.opts,b()),t.data.eventData&&(d=t.data.eventData.spikeTimes,g=t.data.eventData.discriminationValues,b())};function T(t,o){let i=!1;return()=>{i||(i=!0,setTimeout(()=>{i=!1,t()},o))}}async function M(){if(!u||!n||!d||!g)return;const{margins:t,canvasWidth:o,canvasHeight:i,visibleStartTimeSec:s,visibleEndTimeSec:c,valueScaleFactor:l}=n;u.width=o,u.height=i;const e=u.getContext("2d");if(!e)return;e.clearRect(0,0,o,i);const r=a=>t.left+(o-t.left-t.right)*(a-s)/(c-s),f=a=>n?i-t.bottom-(i-t.top-t.bottom)*(a*l-n.valMin)/(n.valMax-n.valMin):0,h=x(n.valMin/l,n.valMax/l);for(const a of h)e.strokeStyle="black",e.textAlign="right",e.textBaseline="middle",e.fillText(`${a}`,r(s)-5,f(a)),e.strokeStyle="gray",e.beginPath(),e.moveTo(r(s),f(a)),e.lineTo(r(c),f(a)),e.stroke();for(let a=0;a<2;a++){e.fillStyle=a===0?"blue":"red";for(let v=0;v<d[a].length;v++){const m=d[a][v];if(m<s||m>c)continue;const k=g[a][v],p=r(m),y=f(k);e.beginPath(),e.ellipse(p,y,3,3,0,0,Math.PI*2,!1),e.fill()}}}const b=T(M,100),x=(t,o)=>{const i=Math.abs(o-t),s=Math.pow(10,Math.floor(Math.log10(i))),c=i/s;let l=0;c<2?l=.2:c<5?l=.5:l=1;const e=l*s,r=Math.floor(t/e),f=Math.ceil(o/e),h=[];for(let a=r;a<=f;a++)h.push(a*e);return h}})();
